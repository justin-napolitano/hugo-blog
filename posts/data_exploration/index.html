<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">

    

    <meta name="author" content="Justin Napolitano">
    <meta name="description" content="Overview of European natural gas imports by country and trading partner.">
    <meta name="keywords" content="blog,projects,personal">

    <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://justin-napolitano.github.io/russian_natural_gas.png"/>

<meta name="twitter:title" content="European Natural Gas Imports by Country and Trading Partner"/>
<meta name="twitter:description" content="Overview of European natural gas imports by country and trading partner."/>

    <meta property="og:title" content="European Natural Gas Imports by Country and Trading Partner" />
<meta property="og:description" content="Overview of European natural gas imports by country and trading partner." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://justin-napolitano.github.io/posts/data_exploration/" /><meta property="og:image" content="https://justin-napolitano.github.io/russian_natural_gas.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-04-13T00:00:00+00:00" />




    <title>
  European Natural Gas Imports by Country and Trading Partner · Justin Napolitano
</title>

    
      <link rel="canonical" href="https://justin-napolitano.github.io/posts/data_exploration/">
    

    <link rel="preload" href="../../fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="../../css/coder.min.d9fddbffe6f27e69985dc5fe0471cdb0e57fbf4775714bc3d847accb08f4a1f6.css" integrity="sha256-2f3b/&#43;byfmmYXcX&#43;BHHNsOV/v0d1cUvD2Eesywj0ofY=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="../../css/coder-dark.min.002ee2378e14c7a68f1f0a53d9694ed252090987c4e768023fac694a4fc5f793.css" integrity="sha256-AC7iN44Ux6aPHwpT2WlO0lIJCYfE52gCP6xpSk/F95M=" crossorigin="anonymous" media="screen" />
      
    

    

    

    <link rel="icon" type="image/png" href="../../img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../img/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="../../images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.92.2" />
  </head>

  
  
    
  
  <body class="preload-transitions colorscheme-auto">
    
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="../../">
      Justin Napolitano
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="../../about">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="../../projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="../../current_resume.pdf">Resume</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="../../posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="../../contact/">Contact</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://justin-napolitano.github.io/posts/data_exploration/">
              European Natural Gas Imports by Country and Trading Partner
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa fa-calendar" aria-hidden="true"></i>
              <time datetime="2022-04-13T00:00:00Z">
                April 13, 2022
              </time>
            </span>
            <span class="reading-time">
              <i class="fa fa-clock-o" aria-hidden="true"></i>
              5-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa fa-folder" aria-hidden="true"></i>
    <a href="../../categories/energy/">energy</a>
      <span class="separator">•</span>
    <a href="../../categories/project/">project</a>
      <span class="separator">•</span>
    <a href="../../categories/python/">python</a>
      <span class="separator">•</span>
    <a href="../../categories/jupyterlab/">jupyterlab</a>
      <span class="separator">•</span>
    <a href="../../categories/analysis/">analysis</a></div>

          <div class="tags">
  <i class="fa fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="../../tags/markdown/">markdown</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/css/">css</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/html/">html</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/python/">python</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/energy/">energy</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/europe/">europe</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="../../tags/natural-gas/">natural-gas</a>
    </span></div>

        </div>
      </header>

      <div>
        
        <h1 id="eurostat-natural-gas-data">
  Eurostat Natural Gas Data
  <a class="heading-link" href="#eurostat-natural-gas-data">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<h2 id="import-and-procedural-functions">
  Import and Procedural Functions
  <a class="heading-link" href="#import-and-procedural-functions">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="font-weight:bold">import</span> <span style="font-weight:bold">pandas</span> <span style="font-weight:bold">as</span> <span style="font-weight:bold">pd</span>
<span style="font-weight:bold">import</span> <span style="font-weight:bold">matplotlib.pyplot</span> <span style="font-weight:bold">as</span> <span style="font-weight:bold">plt</span>
<span style="font-weight:bold">import</span> <span style="font-weight:bold">geopandas</span> <span style="font-weight:bold">as</span> <span style="font-weight:bold">gpd</span>
<span style="font-weight:bold">import</span> <span style="font-weight:bold">folium</span>
<span style="font-weight:bold">import</span> <span style="font-weight:bold">contextily</span> <span style="font-weight:bold">as</span> <span style="font-weight:bold">cx</span>
<span style="font-weight:bold">import</span> <span style="font-weight:bold">rtree</span>
<span style="font-weight:bold">from</span> <span style="font-weight:bold">zlib</span> <span style="font-weight:bold">import</span> crc32
<span style="font-weight:bold">import</span> <span style="font-weight:bold">hashlib</span>
<span style="font-weight:bold">from</span> <span style="font-weight:bold">shapely.geometry</span> <span style="font-weight:bold">import</span> Point, LineString, Polygon
<span style="font-weight:bold">import</span> <span style="font-weight:bold">numpy</span> <span style="font-weight:bold">as</span> <span style="font-weight:bold">np</span>
<span style="font-weight:bold">from</span> <span style="font-weight:bold">scipy.spatial</span> <span style="font-weight:bold">import</span> cKDTree
<span style="font-weight:bold">from</span> <span style="font-weight:bold">shapely.geometry</span> <span style="font-weight:bold">import</span> Point
<span style="font-weight:bold">from</span> <span style="font-weight:bold">haversine</span> <span style="font-weight:bold">import</span> Unit
<span style="font-weight:bold">from</span> <span style="font-weight:bold">geopy.distance</span> <span style="font-weight:bold">import</span> distance
<span style="font-weight:bold">import</span> <span style="font-weight:bold">re</span> 
</code></pre></div><h2 id="query-strategy">
  Query Strategy
  <a class="heading-link" href="#query-strategy">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h3 id="imports">
  Imports
  <a class="heading-link" href="#imports">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>TO many to list&hellip; I&rsquo;ll ad them as I go below</p>
<h2 id="glossary">
  Glossary
  <a class="heading-link" href="#glossary">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h3 id="units">
  Units
  <a class="heading-link" href="#units">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>Data should be reported in Terajoules (TJ) on the basis of Gross calorific values (GCV) and in million
cubic metres (at 15oC and 760 mm Hg, i.e. Standard Conditions)</p>
<h4 id="source">
  Source
  <a class="heading-link" href="#source">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h4>
<p><a href="https://ec.europa.eu/eurostat/documents/38154/10015688/Gas-Instructions-2018.pdf/2c78ed79-88fe-47ce-91f6-6069081755fb">https://ec.europa.eu/eurostat/documents/38154/10015688/Gas-Instructions-2018.pdf/2c78ed79-88fe-47ce-91f6-6069081755fb</a></p>
<h2 id="data">
  Data
  <a class="heading-link" href="#data">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h2 id="converting-all-tsv-to-csv-documents">
  Converting all tsv to csv documents
  <a class="heading-link" href="#converting-all-tsv-to-csv-documents">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<h3 id="building-tsv-file-list">
  Building tsv file list
  <a class="heading-link" href="#building-tsv-file-list">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="font-weight:bold">import</span> <span style="font-weight:bold">glob</span>
 
<span style="font-style:italic"># assign directory</span>
directory = <span style="font-style:italic">&#39;/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng&#39;</span>
 

tsv_list = [x <span style="font-weight:bold">for</span> x <span style="font-weight:bold">in</span> glob.iglob(<span style="font-style:italic">f</span><span style="font-style:italic">&#39;</span><span style="font-weight:bold;font-style:italic">{</span>directory<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">/*.tsv&#39;</span>)]

print(tsv_list)


</code></pre></div><pre><code>['/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/imports_montth.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_imports.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_exports.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/supply_transformation_consumption.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/non_house_consumption.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_stocks.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/gas_prices.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/house_hold_consumption.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/exports_month.tsv', '/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/transport_costs.tsv']
</code></pre>
<h3 id="converting-to-csv">
  Converting to CSV
  <a class="heading-link" href="#converting-to-csv">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>The columns of this data are ugly. Some are in csv format and others are in tab.</p>
<p>I&rsquo;ll convert the entire document to csv to simplify our work.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="font-weight:bold">for</span> tsv_file <span style="font-weight:bold">in</span> tsv_list:
  filepath = tsv_file
  outfile = filepath.replace(<span style="font-style:italic">&#39;tsv&#39;</span>,<span style="font-style:italic">&#39;csv&#39;</span>)
    
  <span style="font-style:italic"># reading given tsv file </span>
  <span style="font-weight:bold">with</span> open(filepath, <span style="font-style:italic">&#39;r&#39;</span>) <span style="font-weight:bold">as</span> myfile:   
    <span style="font-weight:bold">with</span> open(outfile, <span style="font-style:italic">&#39;w&#39;</span>) <span style="font-weight:bold">as</span> csv_file: 
      <span style="font-weight:bold">for</span> line <span style="font-weight:bold">in</span> myfile: 
          
        <span style="font-style:italic"># Replace every tab with comma </span>
        fileContent = re.sub(<span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">\t</span><span style="font-style:italic">&#34;</span>, <span style="font-style:italic">&#34;,&#34;</span>, line) 
          
        <span style="font-style:italic"># Writing into csv file </span>
        csv_file.write(fileContent) 
    
  <span style="font-style:italic"># output </span>
  print(outfile)
</code></pre></div><pre><code>/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/imports_montth.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_imports.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_exports.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/supply_transformation_consumption.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/non_house_consumption.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_stocks.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/gas_prices.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/house_hold_consumption.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/exports_month.csv
/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/transport_costs.csv
</code></pre>
<h2 id="natural-gas-imports-data">
  Natural Gas Imports Data
  <a class="heading-link" href="#natural-gas-imports-data">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="font-style:italic">## Importing our DataFrames</span>

filepath = <span style="font-style:italic">&#34;/Users/jnapolitano/Projects/data/EuropeanEnergyData/ng/ng_imports.csv&#34;</span>


<span style="font-style:italic">## Reading the CSV Columns</span>

ng_imports_df = pd.read_csv(filepath, skipinitialspace=<span style="font-weight:bold">True</span>, low_memory=<span style="font-weight:bold">False</span>)

<span style="font-style:italic"># Repacing NA&#39;s</span>
ng_imports_df = ng_imports_df.replace(to_replace=<span style="font-style:italic">&#39;: &#39;</span>, value=0)

<span style="font-style:italic">#coverting to float</span>
ng_imports_df[<span style="font-style:italic">&#39;1990 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1990 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1991 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1991 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1992 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1992 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1993 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1993 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1994 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1994 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1995 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1995 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1996 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1996 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1997 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1997 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1998 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1998 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;1999 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;1999 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2000 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2000 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2001 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2001 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2002 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2002 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2003 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2003 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2004 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2004 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2005 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2005 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2006 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2006 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2007 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2007 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2008 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2008 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2009 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2009 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2010 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2010 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2011 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2011 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2012 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2012 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2013 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2013 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2014 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2014 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2015 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2015 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2016 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2016 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2017 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2017 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2018 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2018 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2019 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2019 &#39;</span>].astype(float)
ng_imports_df[<span style="font-style:italic">&#39;2020 &#39;</span>] = ng_imports_df[<span style="font-style:italic">&#39;2020 &#39;</span>].astype(float)

ng_imports_df.keys()

<span style="font-style:italic">## This data set has spaces at the end of the years... Be aware of this when trying to findd keys</span>

</code></pre></div><pre><code>Index(['siec', 'partner', 'unit', 'geo', '2020 ', '2019 ', '2018 ', '2017 ',
       '2016 ', '2015 ', '2014 ', '2013 ', '2012 ', '2011 ', '2010 ', '2009 ',
       '2008 ', '2007 ', '2006 ', '2005 ', '2004 ', '2003 ', '2002 ', '2001 ',
       '2000 ', '1999 ', '1998 ', '1997 ', '1996 ', '1995 ', '1994 ', '1993 ',
       '1992 ', '1991 ', '1990 '],
      dtype='object')
</code></pre>
<h3 id="natural-gas-imports-descriptive-statistics">
  Natural Gas Imports Descriptive Statistics
  <a class="heading-link" href="#natural-gas-imports-descriptive-statistics">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ng_imports_df.describe()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="replace-0s-with-numpy-nan">
  Replace 0&rsquo;s with Numpy NAN
  <a class="heading-link" href="#replace-0s-with-numpy-nan">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ng_imports_df.replace(0, np.nan, inplace=<span style="font-weight:bold">True</span>)

</code></pre></div><h3 id="remove-nan-rows-for-the-dataframe">
  Remove NAN Rows for the dataframe
  <a class="heading-link" href="#remove-nan-rows-for-the-dataframe">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>I remove rows where all of the rows are 0 to reduce the size of the dataframe for analysis.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="font-style:italic">## There are 30 years of data in the set. If there are 30 columns per row with nan values that row will be dropped.</span>
ng_imports_df.dropna(thresh=30, axis=0, inplace=<span style="font-weight:bold">True</span>)
<span style="font-style:italic">#df.dropna(thresh=2)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ng_imports_df.describe()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="grouping-totals-by-geostate">
  Grouping Totals by Geo/State
  <a class="heading-link" href="#grouping-totals-by-geostate">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">geo_imports_df = ng_imports_df.groupby([<span style="font-style:italic">&#39;geo&#39;</span>, <span style="font-style:italic">&#39;partner&#39;</span>,<span style="font-style:italic">&#39;unit&#39;</span>]).sum()

</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">geo_imports_df
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>With the tables compiled we can now look more in depthly at the imports of natural gas in europe.</p>
<h2 id="state-code-reference-sheet-source">
  State Code Reference Sheet Source
  <a class="heading-link" href="#state-code-reference-sheet-source">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><a href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Glossary:Country_codes">https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Glossary:Country_codes</a></p>
<h3 id="german-totals">
  German Totals
  <a class="heading-link" href="#german-totals">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_totals_df = geo_imports_df.query(<span style="font-style:italic">&#39;geo==&#34;DE&#34;&#39;</span>)
<span style="font-style:italic">#geo_imports_df.loc[pd.IndexSlice[:,&#39;DE&#39;],:]</span>

</code></pre></div><p>German Totals Bar Chart</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_totals_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15), kind = <span style="font-style:italic">&#39;bar&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_28_1.png" alt="png"></p>
<h3 id="german-totals-line">
  German Totals Line
  <a class="heading-link" href="#german-totals-line">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>Only including long term partners</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_totals_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15), kind = <span style="font-style:italic">&#39;line&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_30_1.png" alt="png"></p>
<h3 id="french-totals">
  French Totals
  <a class="heading-link" href="#french-totals">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_totals_df=geo_imports_df.query(<span style="font-style:italic">&#39;geo==&#34;FR&#34;&#39;</span>)
french_totals_df
<span style="font-style:italic">#geo_imports_df.loc[pd.IndexSlice[:,&#39;DE&#39;],:]</span>

</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="french-totals-bar-chart">
  French Totals Bar Chart
  <a class="heading-link" href="#french-totals-bar-chart">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_totals_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(20,15), kind = <span style="font-style:italic">&#39;bar&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_34_1.png" alt="png"></p>
<h3 id="french-totals-line">
  French Totals Line
  <a class="heading-link" href="#french-totals-line">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>Only long term partners</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_totals_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15), kind = <span style="font-style:italic">&#39;line&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_36_1.png" alt="png"></p>
<h2 id="max-importers-per-year">
  Max Importers Per Year
  <a class="heading-link" href="#max-importers-per-year">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">max_imports_df = ng_imports_df.groupby([<span style="font-style:italic">&#39;geo&#39;</span>, <span style="font-style:italic">&#39;partner&#39;</span>,<span style="font-style:italic">&#39;unit&#39;</span>]).max()
</code></pre></div><h3 id="french-maximums">
  French Maximums
  <a class="heading-link" href="#french-maximums">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_max_df=max_imports_df.query(<span style="font-style:italic">&#39;geo==&#34;FR&#34;&#39;</span>)
french_max_df

</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="french-max-bar-chart">
  French Max Bar Chart
  <a class="heading-link" href="#french-max-bar-chart">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_max_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15),kind = <span style="font-style:italic">&#39;bar&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_42_1.png" alt="png"></p>
<h3 id="french-max-line">
  French Max Line
  <a class="heading-link" href="#french-max-line">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>** Only long term partners</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">french_max_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15))

</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_44_1.png" alt="png"></p>
<h2 id="german-maximums">
  German Maximums
  <a class="heading-link" href="#german-maximums">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_max_df = max_imports_df.query(<span style="font-style:italic">&#39;geo==&#34;DE&#34;&#39;</span>)
german_max_df
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="german-max-bar-chart">
  German Max Bar Chart
  <a class="heading-link" href="#german-max-bar-chart">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_max_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15),kind = <span style="font-style:italic">&#39;bar&#39;</span>)
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_48_1.png" alt="png"></p>
<h3 id="german-max-line">
  German Max Line
  <a class="heading-link" href="#german-max-line">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>** Only long term partners</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">german_max_df.plot(legend=<span style="font-weight:bold">True</span>, figsize=(15,15))

</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='geo,partner,unit'&gt;
</code></pre>
<p><img src="output_50_1.png" alt="png"></p>
<h2 id="gas-partners">
  Gas Partners
  <a class="heading-link" href="#gas-partners">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">partners_sum_df = ng_imports_df.groupby([<span style="font-style:italic">&#39;partner&#39;</span>, <span style="font-style:italic">&#39;geo&#39;</span>,<span style="font-style:italic">&#39;unit&#39;</span>]).sum()
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">partners_sum_df
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="russian-partners">
  Russian Partners
  <a class="heading-link" href="#russian-partners">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">russian_partners_sum_df= partners_sum_df.query(<span style="font-style:italic">&#39;partner==&#34;RU&#34;&#39;</span>)
</code></pre></div><h3 id="russian-partner-bar-plot">
  Russian Partner Bar Plot
  <a class="heading-link" href="#russian-partner-bar-plot">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">russian_partners_sum_df.plot(kind=<span style="font-style:italic">&#39;bar&#39;</span>, figsize = (20,10))
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='partner,geo,unit'&gt;
</code></pre>
<p><img src="output_57_1.png" alt="png"></p>
<h3 id="russian-partner-line-graph">
  Russian Partner Line Graph
  <a class="heading-link" href="#russian-partner-line-graph">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h3>
<p>Only will include partners that hvae traded for 30 years.  This is a good indicator of long term fossil fuel dependency.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">russian_partners_sum_df.plot(kind=<span style="font-style:italic">&#39;line&#39;</span>, figsize = (20,10))
</code></pre></div><pre><code>&lt;AxesSubplot:xlabel='partner,geo,unit'&gt;
</code></pre>
<p><img src="output_59_1.png" alt="png"></p>

      </div>


      <footer>
        

<section class="see-also">
  
    
    
    
  
</section>


        
        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    ©
    
    2022
     Justin Napolitano 
    ·
    
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

    </main>

    
      
      <script src="../../js/coder.min.39a51230dce2ac866c049b52573e38bf60666af4bc63c1bdf203b9b2d95b1cd6.js" integrity="sha256-OaUSMNzirIZsBJtSVz44v2BmavS8Y8G98gO5stlbHNY="></script>
    

    

    

    

    

    

    

    

    
  </body>

</html>
